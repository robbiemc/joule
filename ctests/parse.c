#include <assert.h>

#include "parse.h"

/*
 * puts File.read('tests/hello.luac').bytes.to_a.map{ |b|
 *   sprintf "\\x%02x", b
 * }.each_slice(18){ |s| puts '"' + s.join + '"' }
 */
char to_parse[] =
  "\x1b\x4c\x75\x61\x51\x00\x01\x04\x08\x04\x08\x00\x11\x00\x00\x00\x00\x00"
  "\x00\x00\x40\x74\x65\x73\x74\x73\x2f\x68\x65\x6c\x6c\x6f\x2e\x6c\x75\x61"
  "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x04\x07\x00\x00\x00\x05"
  "\x00\x00\x00\x06\x40\x40\x00\x41\x80\x00\x00\x85\xc0\x00\x00\xc1\x00\x01"
  "\x00\x1c\x40\x00\x02\x1e\x00\x80\x00\x05\x00\x00\x00\x04\x03\x00\x00\x00"
  "\x00\x00\x00\x00\x69\x6f\x00\x04\x06\x00\x00\x00\x00\x00\x00\x00\x77\x72"
  "\x69\x74\x65\x00\x04\x13\x00\x00\x00\x00\x00\x00\x00\x48\x65\x6c\x6c\x6f"
  "\x20\x77\x6f\x72\x6c\x64\x2c\x20\x66\x72\x6f\x6d\x20\x00\x04\x09\x00\x00"
  "\x00\x00\x00\x00\x00\x5f\x56\x45\x52\x53\x49\x4f\x4e\x00\x04\x03\x00\x00"
  "\x00\x00\x00\x00\x00\x21\x0a\x00\x00\x00\x00\x00\x07\x00\x00\x00\x03\x00"
  "\x00\x00\x03\x00\x00\x00\x03\x00\x00\x00\x03\x00\x00\x00\x03\x00\x00\x00"
  "\x03\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
;

int main() {
  /* Right now, mainly a sanity check that parsing actually works */
  luac_file_t file;
  luac_parse(&file, to_parse);

  /* TODO: actually verify parsed entries */

  return 0;
}
